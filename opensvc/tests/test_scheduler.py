import core.scheduler


class TestSchedules:
    @staticmethod
    def test_schedules():
        """
        Schedule definitions
        """
        tests = [
            ("", "2015-02-27 10:00", False, None),
            ("@0", "2015-02-27 10:00", False, None),
            ("*@0", "2015-02-27 10:00", False, None),
            ("*", "2015-02-27 10:00", True, None),
            ("*@61", "2015-02-27 10:00", True, None),
            ("@10", "2015-02-27 10:00", True, "2015-02-27 08:59"),
            ("@10", "2015-02-27 10:00", False, "2015-02-27 09:52"),
            ("09:00-09:20", "2015-02-27 10:00", False, None),
            ("09:00-09:20@31", "2015-02-27 10:00", False, None),
            ("09:00-09:00", "2015-02-27 10:00", False, None),
            ("09:20-09:00", "2015-02-27 10:00", True, None),
            ("09:00", "2015-02-27 10:00", False, None),
            ("09:00-09:20", "2015-02-27 09:09", True, None),
            ("09:00-09:20@31", "2015-02-27 09:09", True, None),
            ("09:00-09:00", "2015-02-27 09:09", True, None),
            ("09:20-09:00", "2015-02-27 09:09", False, None),
            ("09:00", "2015-02-27 09:09", True, None),
            ("* fri", "2015-10-09 10:00", True, None),
            ("* fri", "2015-10-08 10:00", False, None),
            ("* *:last", "2015-01-30 10:00", True, None),
            ("* *:last", "2015-01-31 10:00", True, None),
            ("* *:-1", "2015-01-31 10:00", True, None),
            ("* *:-1", "2015-01-24 10:00", False, None),
            ("* *:-2", "2015-01-31 10:00", False, None),
            ("* :last", "2015-01-30 10:00", False, None),
            ("* :last", "2015-01-31 10:00", True, None),
            ("* :-1", "2015-01-31 10:00", True, None),
            ("* :-2", "2015-01-30 10:00", True, None),
            ("* :-2", "2015-01-31 10:00", False, None),
            ("* :-2", "2015-01-05 10:00", False, None),
            ("* :5", "2015-01-05 10:00", True, None),
            ("* :+5", "2015-01-05 10:00", True, None),
            ("* :fifth", "2015-01-05 10:00", True, None),
            ("* :5", "2015-01-06 10:00", False, None),
            ("* :+5", "2015-01-06 10:00", False, None),
            ("* :fifth", "2015-01-06 10:00", False, None),
            ("* * * jan", "2015-01-06 10:00", True, None),
            ("* * * jan-feb", "2015-01-06 10:00", True, None),
            ("* * * %2", "2015-01-06 10:00", False, None),
            ("* * * %2+1", "2015-01-06 10:00", True, None),
            ("* * * jan-feb%2", "2015-01-06 10:00", False, None),
            ("* * * jan-feb%2+1", "2015-01-06 10:00", True, None),
            ("18:00-18:59@60 wed", "2016-08-31 18:00", True, None),
            ("18:00-18:59@60 wed", "2016-08-30 18:00", False, None),
            ("23:00-23:59@61 *:first", "2016-09-01 23:00", True, None),
            ("23:00-23:59", "2016-09-01 23:00", True, None),
            ("23:00-00:59", "2016-09-01 23:00", True, None),
            # syntax errors
            ("23:00-23:59@61 *:first:*", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 *:", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 *:*", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 * * %2%3", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 * * %2+1+2", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 * * %foo", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 * * %2+foo", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 freday", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 * * junuary", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61 * * %2%3", "2016-09-01 23:00", None, None),
            ("23:00-23:59-01:00@61", "2016-09-01 23:00", None, None),
            ("23:00-23:59:00@61 * * %2%3", "2016-09-01 23:00", None, None),
            ("23:00-23:59@61@10", "2016-09-01 23:00", None, None),
        ]
        sched = core.scheduler.Scheduler()
        for test in tests:
            assert sched.test_schedule(*test)
